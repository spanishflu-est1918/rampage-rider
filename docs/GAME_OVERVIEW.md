# Rampage Rider - Game Overview

## 1. Game Concept

**Rampage Rider** is a high-octane, isometric chaos simulator set in a festive German Christmas market.

**The Goal:** Cause maximum mayhem, rack up points, and climb the vehicle tier ladder while surviving an escalating police response. It draws inspiration from classic arcade score-attack games and the chaotic freedom of early GTA titles.

**Theme:** "Holiday Mayhem" - destruction amidst glühwein stalls, Christmas lights, and snowy cobblestone streets.

---

## 2. Complete Feature List

### Core Gameplay
- **Isometric View:** Fixed-angle orthographic camera with smooth player tracking and screen shake effects.
- **Physics Engine:** Fully integrated Rapier 3D physics for movement, collisions, and projectile dynamics.
- **Infinite World:** Procedural generation of city blocks, market stalls, lamp posts, and decorations.

### Entities
- **Player:** Animated character with complex state machine (Idle, Run, Attack, Jump, Stunned, Death).
- **Pedestrians:** Diverse low-poly civilians with wandering AI, panic behaviors, and ragdoll physics.
- **Police:** Tactical AI with multiple unit types (Foot, Bicycle, Motorbike, Car) and escalating tactics.

### Vehicle System
- **5 Progressive Tiers:** From on-foot to an 18-wheeler truck.
- **Mechanics:** Enter/exit vehicles, smooth physics-based acceleration/steering, vehicle health/damage.
- **Upgrade System:** Score-based unlocks spawn "Awaiting Vehicles" that the player can switch to mid-combat.

### Combat & VFX
- **Weapons:** Melee (Knife, Bike Swing), Ranged (Drive-by Shooting), Area of Effect (Motorbike Blast).
- **Destruction:** Destructible environment (Trucks can crush buildings).
- **Blood System:** "Ultrakill"-style directional blood splatters and persistent ground decals.
- **Status Effects:** Taser stun minigame (QTE), hit stuns, knockback.

---

## 3. Game Systems

### Progression (The Tier Ladder)

Unlock new vehicles by accumulating **SCORE**. Score is generated by kills, combos, and multipliers.

| Tier | Vehicle | Requirement | Abilities |
|------|---------|-------------|-----------|
| **1. Foot Fiend** | None (Running) | 0 pts | Knife attack, Sprint, Jump |
| **2. Bike Butcher** | Bicycle | 150 pts | Faster movement, Melee swing attack |
| **3. Moto Maniac** | Motorbike | 1,200 pts | High speed, Drive-by shooting, Blast knockback |
| **4. Sedan Sovereign** | Monster Truck | 4,000 pts | Run over enemies, Ragdoll physics impact |
| **5. Road Destroyer** | 18-Wheeler | 10,000 pts | **Destroys buildings**, Massive health, Unstoppable |

### Combat & Scoring

- **Combo System:** Kills chain together. A timer (5s) resets on each kill.
    - **10+ Combo:** Unlocks "Rampage Mode" (unlimited melee targets/cleave).
    - **Combo Milestones:** Announcements at 5/10/15/20/30/50 kills.
- **Multipliers:**
    - **Pursuit (2x):** Active when police are chasing.
    - **Panic (2x):** Bonus for killing fleeing pedestrians.
- **Juice Effects:**
    - **Panic Freeze:** 0.6s "deer-in-headlights" before pedestrians flee.
    - **Tier Unlock Slow-Mo:** 0.3s time dilation on vehicle upgrade.
    - **Crowd Surge:** 60→100 pedestrians for 15s after tier unlock.
- **Heat System (0-100%):**
    - Increases with kills. Decays at 0.5/s (3x faster after 10s idle).
    - Determines **QUANTITY** of police spawns (staggered at 25/45/50/55/75%).
- **Wanted Level (0-2 Stars):**
    - Increases with *Cop* kills. Decays by 1 every 45s without cop kills.
    - Determines **QUALITY** of police attacks (Punch → Taser → Shoot).

### Police Escalation

The police response adapts to your threat level:

1. **Low Heat:** Single Foot Cops and Bicycle Cops.
2. **Medium Heat:** "Scout" Motorbike units.
3. **High Heat:** "Swarm" Motorbike units (flanking AI) and Cop Cars.
4. **Max Heat:** "Boss" Motorbike units and heavy pursuit.

---

## 4. Technical Architecture

### Core Stack

- **Engine:** Custom `Engine` class orchestrating Three.js (Rendering), Rapier (Physics), and Yuka (AI).
- **Language:** TypeScript.
- **UI Framework:** React with `shadcn/ui` and `@8bitcn` (Retro registry).

### Key Subsystems

- **PhysicsWorld:** Wrapper around `@dimforge/rapier3d-compat`. Handles kinematic controllers for characters and dynamic bodies for vehicles.
- **AIManager:** Wrapper around `yuka`. Manages steering behaviors (Seek, Flee, Arrive, Wander) and spatial partitioning.
- **Managers:** Component-based architecture (CrowdManager, CopManager, BuildingManager) handling entity lifecycles and object pooling.
- **Rendering:**
    - **InstancedBlobShadows:** Batched rendering for hundreds of entity shadows (1 draw call).
    - **BloodDecalSystem:** Instanced meshes for persistent blood effects.
    - **ParticleSystem:** BufferGeometry-based particle emitter for blood and debris.

---

## 5. Visual Style

- **Aesthetic:** Low-poly 3D with a vibrant, retro color palette.
- **Atmosphere:** Winter night. Dark background with warm point lights from lamp posts and market stalls.
- **UI:** 8-bit/Pixel-art style interface with "Press Start 2P" font.
- **Feedback:** Heavy use of "juice" effects - screen shake, hit stops, flash-on-hit, and floating combat text.

---

## 6. Controls

| Action | Key / Input | Context |
|--------|-------------|---------|
| **Move/Steer** | Arrow Keys | Camera-relative movement |
| **Walk** | `SHIFT` (Hold) | Slows movement (sprint is default) |
| **Action** | `SPACE` | Context sensitive (see below) |
| **Pause** | `ESC` | Toggles pause menu |
| **Camera** | `Q/E/W/S` | Rotate/tilt debug camera |
| **Reset Camera** | `R` | Return to auto-follow |

**The "Action" Button (SPACE) Contexts:**

1. **Escape Taser:** Mash rapidly when stunned to break free.
2. **Switch Vehicle:** Press when near an "Awaiting Vehicle" (upgrade).
3. **Enter Vehicle:** Press when near an empty vehicle.
4. **Attack:** Default behavior (Knife, Bike Kick, or Shoot).

---

## 7. Current State

**Status:** Phase 6 (Polish & Tuning)
**Version:** Alpha

### Working Features

- [x] Full tier progression system
- [x] All vehicle types and physics
- [x] Complete combat system (Melee, Ranged, Vehicle)
- [x] Police AI, heat, and escalation logic
- [x] City generation with destructible buildings
- [x] Performance optimizations (Pooling, Instancing)
- [x] Retro UI and HUD
- [x] Motorbike blast attack with visual FX
- [x] Truck directional damage (sides/back vulnerable)

### Planned / In Progress

- [ ] Audio System (Sound effects, engine noises, background music)
- [ ] Persistent high scores
- [ ] Additional building variety
- [ ] Meta-progression (unlockable modifiers)
- [x] ~~Combo scaling for motorbike blast~~ (5→8→∞ at 10+/15+ combo)
- [x] ~~Explicit "rampage mode" at high combo~~ (combo announcements + unlimited kills)

---

## 8. Documentation

| Document | Description |
|----------|-------------|
| [GAMEPLAY_TUNING.md](./GAMEPLAY_TUNING.md) | Master tuning reference for all parameters |
| [COP_ESCALATION.md](./COP_ESCALATION.md) | Cop spawning, heat, wanted stars |
| [RAMPAGE_ESCALATION.md](./RAMPAGE_ESCALATION.md) | Combo system, tier progression, kill mechanics |
| [IMPLEMENTATION_PLAN.md](../IMPLEMENTATION_PLAN.md) | Development roadmap |
| [CHANGELOG.md](../CHANGELOG.md) | Complete change history |
